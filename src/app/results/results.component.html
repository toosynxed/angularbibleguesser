<div class="container">
  <header>
    <h1>Game Over!</h1>
    <p>Here's how you did.</p>
  </header>

  <main>
    <div class="total-score">
      <h2>Total Score: {{ totalScore }} / {{ results.length * 100 }}</h2>
    </div>

    <div class="results-list">
      <div *ngFor="let result of results; let i = index" class="result-card" (click)="toggleExpand(i)">
        <div class="result-summary">
          <h3>Round {{ i + 1 }}</h3>
          <p class="score"><strong>Score:</strong> {{ result.score }} / 100</p>
          <div class="stars">
            <span *ngFor="let _ of getStarArray(result.stars)" class="star filled">★</span>
            <span *ngFor="let _ of getStarArray(3 - result.stars)" class="star">☆</span>
          </div>
          <span class="expand-icon">{{ expandedIndex === i ? '▲' : '▼' }}</span>
        </div>

        <div class="details" *ngIf="expandedIndex === i">
          <p><strong>Correct Verse:</strong> {{ result.verse.bookName }} {{ result.verse.chapter }}:{{ result.verse.verse }}</p>
          <p><strong>Your Guess:</strong>
            <span *ngIf="result.guess">{{ result.guess.book }} {{ result.guess.chapter }}:{{ result.guess.verse }}</span>
            <span *ngIf="!result.guess">Invalid</span>
          </p>
          <p class="verse-text">"{{ result.verse.text }}"</p>
          <div class="indicators">
            <div class="indicator">
              <span class="circle" [class.correct]="result.isBookCorrect" [class.incorrect]="!result.isBookCorrect"></span>
              <span>Book</span>
            </div>
            <div class="indicator">
              <span class="circle" [class.correct]="result.isChapterCorrect" [class.incorrect]="!result.isChapterCorrect"></span>
              <span>Chapter</span>
            </div>
            <div class="indicator">
              <span class="circle" [class.correct]="result.isVerseCorrect" [class.incorrect]="!result.isVerseCorrect"></span>
              <span>Verse</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="share-container">
      <h3>Share this Game</h3>
      <p>Send this code to a friend to let them play the same verses!</p>
      <div class="code-actions">
        <input type="text" [value]="shareCode" readonly>
        <button (click)="copyCode()">{{ copyButtonText }}</button>
      </div>
    </div>

    <div class="actions">
      <a routerLink="/">Play Again</a>
    </div>
  </main>
</div>
